{"code":"!function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"/dist/\",r(r.s=0)}([function(e,t,r){\"use strict\";function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}r.r(t);var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.game=t}return function(e,t,r){t&&i(e.prototype,t),r&&i(e,r)}(e,[{key:\"update\",value:function(){this.game.update(0)}},{key:\"draw\",value:function(){this.game.draw(0)}},{key:\"initLoop\",value:function(){var e=this;e.game.init(),requestAnimationFrame(function(){return e.loop(e)})}},{key:\"loop\",value:function(e){e.update(),e.draw(),requestAnimationFrame(function(){return e.loop(e)})}}]),e}();function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(t,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),this.p_oRawPlainArray=new ArrayBuffer(3*Float32Array.BYTES_PER_ELEMENT),this.p_afPlainArrayView=new Float32Array(this.p_oRawPlainArray),this.p_afPlainArrayView[0]=t,this.p_afPlainArrayView[1]=r,this.p_afPlainArrayView[2]=i}return function(e,t,r){t&&n(e.prototype,t),r&&n(e,r)}(e,[{key:\"x\",get:function(){return this.p_afPlainArrayView[0]}},{key:\"y\",get:function(){return this.p_afPlainArrayView[1]}},{key:\"z\",get:function(){return this.p_afPlainArrayView[2]}},{key:\"array\",get:function(){return this.p_oRawPlainArray}},{key:\"byteArray\",get:function(){return new Uint8Array(this.p_oRawPlainArray)}}]),e}();function s(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(t,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0),this.p_oRawPlainArray=new ArrayBuffer(4*Float32Array.BYTES_PER_ELEMENT),this.p_afPlainArrayView=new Float32Array(this.p_oRawPlainArray),this.p_afPlainArrayView[0]=t,this.p_afPlainArrayView[1]=r,this.p_afPlainArrayView[2]=i,this.p_afPlainArrayView[3]=a}return function(e,t,r){t&&s(e.prototype,t),r&&s(e,r)}(e,[{key:\"x\",get:function(){return this.p_afPlainArrayView[0]}},{key:\"y\",get:function(){return this.p_afPlainArrayView[1]}},{key:\"z\",get:function(){return this.p_afPlainArrayView[2]}},{key:\"w\",get:function(){return this.p_afPlainArrayView[3]}},{key:\"array\",get:function(){return this.p_oRawPlainArray}},{key:\"byteArray\",get:function(){return new Uint8Array(this.p_oRawPlainArray)}}]),e}();function l(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f=function(){function e(t,r,i,a,n,o,s,h,l,f,u,c,p,y,_,P){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===f&&(f=0),void 0===u&&(u=0),void 0===c&&(c=0),void 0===p&&(p=0),void 0===y&&(y=0),void 0===_&&(_=0),void 0===P&&(P=0),this.p_oRawPlainArray=new ArrayBuffer(16*Float32Array.BYTES_PER_ELEMENT),this.p_afPlainArrayView=new Float32Array(this.p_oRawPlainArray),this.p_afPlainArrayView[0]=t,this.p_afPlainArrayView[1]=n,this.p_afPlainArrayView[2]=l,this.p_afPlainArrayView[3]=p,this.p_afPlainArrayView[4]=r,this.p_afPlainArrayView[5]=o,this.p_afPlainArrayView[6]=f,this.p_afPlainArrayView[7]=y,this.p_afPlainArrayView[8]=i,this.p_afPlainArrayView[9]=s,this.p_afPlainArrayView[10]=u,this.p_afPlainArrayView[11]=_,this.p_afPlainArrayView[12]=a,this.p_afPlainArrayView[13]=h,this.p_afPlainArrayView[14]=c,this.p_afPlainArrayView[15]=P}return function(e,t,r){t&&l(e.prototype,t),r&&l(e,r)}(e,[{key:\"makeIdentity\",value:function(){return this.p_afPlainArrayView[0]=1,this.p_afPlainArrayView[1]=0,this.p_afPlainArrayView[2]=0,this.p_afPlainArrayView[3]=0,this.p_afPlainArrayView[4]=0,this.p_afPlainArrayView[5]=1,this.p_afPlainArrayView[6]=0,this.p_afPlainArrayView[7]=0,this.p_afPlainArrayView[8]=0,this.p_afPlainArrayView[9]=0,this.p_afPlainArrayView[10]=1,this.p_afPlainArrayView[11]=0,this.p_afPlainArrayView[12]=0,this.p_afPlainArrayView[13]=0,this.p_afPlainArrayView[14]=0,this.p_afPlainArrayView[15]=1,this}},{key:\"makeProjection\",value:function(e,t,r,i){var a=Math.tan(e*Math.PI/360)*r,n=-a,o=a*t,s=-o;return this.p_afPlainArrayView[0]=2*r/(o-s),this.p_afPlainArrayView[1]=0,this.p_afPlainArrayView[2]=0,this.p_afPlainArrayView[3]=0,this.p_afPlainArrayView[4]=0,this.p_afPlainArrayView[5]=2*r/(a-n),this.p_afPlainArrayView[6]=0,this.p_afPlainArrayView[7]=0,this.p_afPlainArrayView[8]=(o+s)/(o-s),this.p_afPlainArrayView[9]=(a+n)/(a-n),this.p_afPlainArrayView[10]=-(i+r)/(i-r),this.p_afPlainArrayView[11]=-1,this.p_afPlainArrayView[12]=0,this.p_afPlainArrayView[13]=0,this.p_afPlainArrayView[14]=-2*i*r/(i-r),this.p_afPlainArrayView[15]=0,this}},{key:\"makeRotationX\",value:function(e){return this.p_afPlainArrayView[0]=1,this.p_afPlainArrayView[1]=0,this.p_afPlainArrayView[2]=0,this.p_afPlainArrayView[3]=0,this.p_afPlainArrayView[4]=0,this.p_afPlainArrayView[5]=Math.cos(e),this.p_afPlainArrayView[6]=Math.sin(e),this.p_afPlainArrayView[7]=0,this.p_afPlainArrayView[8]=0,this.p_afPlainArrayView[9]=-Math.sin(e),this.p_afPlainArrayView[10]=Math.cos(e),this.p_afPlainArrayView[11]=0,this.p_afPlainArrayView[12]=0,this.p_afPlainArrayView[13]=0,this.p_afPlainArrayView[14]=0,this.p_afPlainArrayView[15]=1,this}},{key:\"makeRotationY\",value:function(e){return this.p_afPlainArrayView[0]=Math.cos(e),this.p_afPlainArrayView[1]=0,this.p_afPlainArrayView[2]=-Math.sin(e),this.p_afPlainArrayView[3]=0,this.p_afPlainArrayView[4]=0,this.p_afPlainArrayView[5]=1,this.p_afPlainArrayView[6]=0,this.p_afPlainArrayView[7]=0,this.p_afPlainArrayView[8]=Math.sin(e),this.p_afPlainArrayView[9]=0,this.p_afPlainArrayView[10]=Math.cos(e),this.p_afPlainArrayView[11]=0,this.p_afPlainArrayView[12]=0,this.p_afPlainArrayView[13]=0,this.p_afPlainArrayView[14]=0,this.p_afPlainArrayView[15]=1,this}},{key:\"makeRotationZ\",value:function(e){return this.p_afPlainArrayView[0]=Math.cos(e),this.p_afPlainArrayView[1]=Math.sin(e),this.p_afPlainArrayView[2]=0,this.p_afPlainArrayView[3]=0,this.p_afPlainArrayView[4]=-Math.sin(e),this.p_afPlainArrayView[5]=Math.cos(e),this.p_afPlainArrayView[6]=0,this.p_afPlainArrayView[7]=0,this.p_afPlainArrayView[8]=0,this.p_afPlainArrayView[9]=0,this.p_afPlainArrayView[10]=1,this.p_afPlainArrayView[11]=0,this.p_afPlainArrayView[12]=0,this.p_afPlainArrayView[13]=0,this.p_afPlainArrayView[14]=0,this.p_afPlainArrayView[15]=1,this}},{key:\"setTranslation\",value:function(e,t,r){return void 0===e&&(e=this.p_afPlainArrayView[12]),void 0===t&&(t=this.p_afPlainArrayView[13]),void 0===r&&(r=this.p_afPlainArrayView[14]),this.p_afPlainArrayView[12]=e,this.p_afPlainArrayView[13]=t,this.p_afPlainArrayView[14]=r,this}},{key:\"mult\",value:function(e){var t=this.p_afPlainArrayView,r=e.p_afPlainArrayView,i=new Float32Array(16);return i[0]=t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12]*r[3],i[1]=t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13]*r[3],i[2]=t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14]*r[3],i[3]=t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15]*r[3],i[4]=t[0]*r[4]+t[4]*r[5]+t[8]*r[6]+t[12]*r[7],i[5]=t[1]*r[4]+t[5]*r[5]+t[9]*r[6]+t[13]*r[7],i[6]=t[2]*r[4]+t[6]*r[5]+t[10]*r[6]+t[14]*r[7],i[7]=t[3]*r[4]+t[7]*r[5]+t[11]*r[6]+t[15]*r[7],i[8]=t[0]*r[8]+t[4]*r[9]+t[8]*r[10]+t[12]*r[11],i[9]=t[1]*r[8]+t[5]*r[9]+t[9]*r[10]+t[13]*r[11],i[10]=t[2]*r[8]+t[6]*r[9]+t[10]*r[10]+t[14]*r[11],i[11]=t[3]*r[8]+t[7]*r[9]+t[11]*r[10]+t[15]*r[11],i[12]=t[0]*r[12]+t[4]*r[13]+t[8]*r[14]+t[12]*r[15],i[13]=t[1]*r[12]+t[5]*r[13]+t[9]*r[14]+t[13]*r[15],i[14]=t[2]*r[12]+t[6]*r[13]+t[10]*r[14]+t[14]*r[15],i[15]=t[3]*r[12]+t[7]*r[13]+t[11]*r[14]+t[15]*r[15],this.p_afPlainArrayView[0]=i[0],this.p_afPlainArrayView[1]=i[1],this.p_afPlainArrayView[2]=i[2],this.p_afPlainArrayView[3]=i[3],this.p_afPlainArrayView[4]=i[4],this.p_afPlainArrayView[5]=i[5],this.p_afPlainArrayView[6]=i[6],this.p_afPlainArrayView[7]=i[7],this.p_afPlainArrayView[8]=i[8],this.p_afPlainArrayView[9]=i[9],this.p_afPlainArrayView[10]=i[10],this.p_afPlainArrayView[11]=i[11],this.p_afPlainArrayView[12]=i[12],this.p_afPlainArrayView[13]=i[13],this.p_afPlainArrayView[14]=i[14],this.p_afPlainArrayView[15]=i[15],this}},{key:\"x\",get:function(){return this.p_afPlainArrayView[0]}},{key:\"y\",get:function(){return this.p_afPlainArrayView[1]}},{key:\"z\",get:function(){return this.p_afPlainArrayView[2]}},{key:\"array\",get:function(){return this.p_oRawPlainArray}},{key:\"byteArray\",get:function(){return new Uint8Array(this.p_oRawPlainArray)}}]),e}();function u(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.p_oGraphicDevice=t,this.p_oVertexDeclaration=r,this.p_oInnerVertexBuffer=this.p_oGraphicDevice.oWebGLContext.createBuffer()}return function(e,t,r){t&&u(e.prototype,t),r&&u(e,r)}(e,[{key:\"setData\",value:function(e){this.p_oInnerVertexBuffer.numItems=e.length;for(var t=new ArrayBuffer(this.p_oVertexDeclaration.GetStride()*e.length),r=new Uint8Array(t),i=0,a=this.p_oVertexDeclaration.GetElementsCount(),n=0;n<e.length;++n){var o=e[n];assert(a===o.GetVertexElementsCount(),\"VertexBuffer::SetData -> VertexDeclaration elements count doesn't match vertex data elements count\");for(var s=0;s<a;++s){for(var h=o.GetVertexElementsDataByteView(s),l=h.length,f=0;f<l;++f)r[i+f]=h[f];i+=l}}var u=this.p_oGraphicDevice.oWebGLContext;u.bindBuffer(u.ARRAY_BUFFER,this.p_oInnerVertexBuffer),u.bufferData(u.ARRAY_BUFFER,r,u.STATIC_DRAW)}},{key:\"vertexCount\",get:function(){return this.p_oInnerVertexBuffer.numItems}}]),e}();function p(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e)}return function(e,t,r){t&&p(e.prototype,t),r&&p(e,r)}(e,[{key:\"init\",value:function(e){this.oWebGLContext=e}},{key:\"compile\",value:function(e){var t=document.getElementById(e);if(t){for(var r=\"\",i=t.firstChild;i;)3===i.nodeType&&(r+=i.textContent),i=i.nextSibling;var a=null;return\"x-shader/x-fragment\"===t.type?a=this.oWebGLContext.createShader(this.oWebGLContext.FRAGMENT_SHADER):\"x-shader/x-vertex\"===t.type&&(a=this.oWebGLContext.createShader(this.oWebGLContext.VERTEX_SHADER)),this.oWebGLContext.shaderSource(a,r),this.oWebGLContext.compileShader(a),this.oWebGLContext.getShaderParameter(a,this.oWebGLContext.COMPILE_STATUS)||alert(this.oWebGLContext.getShaderInfoLog(a)),a}}}]),e}();function _(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.oWebGLContext=void 0}return function(e,t,r){t&&_(e.prototype,t),r&&_(e,r)}(e,[{key:\"init\",value:function(e){this.oWebGLContext=e}},{key:\"clear\",value:function(){this.oWebGLContext.viewport(0,0,this.oWebGLContext.viewportWidth,this.oWebGLContext.viewportHeight),this.oWebGLContext.clear(this.oWebGLContext.COLOR_BUFFER_BIT|this.oWebGLContext.DEPTH_BUFFER_BIT)}},{key:\"draw\",value:function(e,t,r,i){var a=void 0;switch(t){case DrawModes.LINES:a=this.oWebGLContext.LINES;break;case DrawModes.LINE_LOOP:a=this.oWebGLContext.LINE_LOOP;break;case DrawModes.LINE_STRIP:a=this.oWebGLContext.LINE_STRIP;break;case DrawModes.POINTS:a=this.oWebGLContext.POINTS;break;case DrawModes.TRIANGLES:a=this.oWebGLContext.TRIANGLES;break;case DrawModes.TRIANGLE_STRIP:a=this.oWebGLContext.TRIANGLE_STRIP;break;case DrawModes.TRIANGLE_FAN:a=this.oWebGLContext.TRIANGLE_FAN}this.oWebGLContext.bindBuffer(this.oWebGLContext.ARRAY_BUFFER,e.p_oInnerVertexBuffer),this.oWebGLContext.drawArrays(a,r,i)}},{key:\"aspectRatio\",get:function(){return this.oWebGLContext.viewportWidth/this.oWebGLContext.viewportHeight}},{key:\"clearColor\",set:function(e){this.oWebGLContext.clearColor(e.r,e.g,e.b,e.a)}}]),e}();function w(e){return(w=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A(e,t){return!t||\"object\"!==w(t)&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function m(e,t,r){return(m=\"undefined\"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(e,r,i,a){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),A(this,v(t).call(this,e,r,i,a))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,h),function(e,t,r){t&&d(e.prototype,t),r&&d(e,r)}(t,[{key:\"r\",get:function(){return m(v(t.prototype),\"x\",this)}},{key:\"g\",get:function(){return m(v(t.prototype),\"y\",this)}},{key:\"b\",get:function(){return m(v(t.prototype),\"z\",this)}},{key:\"a\",get:function(){return m(v(t.prototype),\"w\",this)}}],[{key:\"BLACK\",get:function(){return new t(0,0,0,1)}},{key:\"RED\",get:function(){return new t(1,0,0,1)}},{key:\"GREEN\",get:function(){return new t(0,1,0,1)}},{key:\"BLUE\",get:function(){return new t(0,0,1,1)}}]),t}();function V(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e)}return function(e,t,r){t&&V(e.prototype,t),r&&V(e,r)}(e,null,[{key:\"Usages\",get:function(){return{POSITION:0,COLOR:1,NORMAL:2,TEXTURE:3}}},{key:\"Types\",get:function(){return{FLOAT32:0}}},{key:\"Packing\",get:function(){return{VECTOR2:1,VECTOR3:2,VECTOR4:3,COLOR:4}}}]),e}();function x(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.p_oElementArray=[]}return function(e,t,r){t&&x(e.prototype,t),r&&x(e,r)}(e,[{key:\"addElement\",value:function(e,t,r){var i=this.p_oElementArray.length;this.p_oElementArray[i]={USAGE:e,TYPE:t,PACKING:r}}},{key:\"getElement\",value:function(e){return this.p_oElementArray[e]}},{key:\"getElementSize\",value:function(e){var t=this.p_oElementArray[e].TYPE,r=0;switch(this.p_oElementArray[e].PACKING){case C.Packing.VECTOR2:r=2;break;case C.Packing.VECTOR3:r=3;break;case C.Packing.VECTOR4:case C.Packing.COLOR:r=4}var i=0;switch(t){case C.Types.FLOAT32:i=Float32Array.BYTES_PER_ELEMENT}return i*r}},{key:\"elementsCount\",get:function(){return this.p_oElementArray.length}},{key:\"stride\",get:function(){for(var e=0,t=this.p_oElementArray.length,r=0;r<t;++r)e+=$this.getElementSize(r);return e}}]),e}();function E(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var k=new S;k.addElement(C.Usages.POSITION,C.Types.FLOAT32,C.Packing.VECTOR3);var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.p_oPosition=t}return function(e,t,r){t&&E(e.prototype,t),r&&E(e,r)}(e,[{key:\"GetElementBytes\",value:function(e){var t=void 0;switch(e){case 0:t=this.p_oPosition.byteArray}return t}}],[{key:\"vertexDeclaration\",get:function(){return k}},{key:\"vertexElementsCount\",get:function(){return k.elementsCount}}]),e}();function L(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var O=new S;O.addElement(C.Usages.POSITION,C.Types.FLOAT32,C.Packing.VECTOR3),O.addElement(C.Usages.COLOR,C.Types.FLOAT32,C.Packing.COLOR);var R=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.p_oPosition=t,this.p_oColor=r}return function(e,t,r){t&&L(e.prototype,t),r&&L(e,r)}(e,[{key:\"GetElementBytes\",value:function(e){var t=void 0;switch(e){case 0:t=this.p_oPosition.byteArray;break;case 1:t=this.p_oColor.byteArray}return t}}],[{key:\"vertexDeclaration\",get:function(){return O}},{key:\"vertexElementsCount\",get:function(){return O.elementsCount}}]),e}();function M(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var I=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.p_oGraphicDevice=t,this.p_oShaderCompiler=r,this.p_oVertexShader=void 0,this.p_oFragmentShader=void 0,this.p_oShaderProgram=void 0,this.p_oColorVertexShader=void 0,this.p_oColorFragmentShader=void 0,this.p_oColorShaderProgram=void 0,this.p_oColorTextureVertexShader=void 0,this.p_oColorTextureFragmentShader=void 0,this.p_oColorTextureShaderProgram=void 0,this.p_oTextureVertexShader=void 0,this.p_oTextureFragmentShader=void 0,this.p_oTextureShaderProgram=void 0,this.p_oCurrentShaderProgram=void 0,this.p_eCurrentEffectState=this.constructor.EffectStates.POSITION,this.p_oWorldMatrix=void 0,this.p_oViewMatrix=void 0,this.p_oProjectionMatrix=void 0,this.p_oWorldViewMatrix=new f,this.p_oWorldViewMatrix.makeIdentity(),this.m_bColorEnabled=!1,this.m_bTextureEnabled=!1}return function(e,t,r){t&&M(e.prototype,t),r&&M(e,r)}(e,[{key:\"init\",value:function(){var e=this.p_oGraphicDevice.oWebGLContext;this.p_oVertexShader=this.p_oShaderCompiler.compile(\"shader-vs\"),this.p_oFragmentShader=this.p_oShaderCompiler.compile(\"shader-fs\"),this.p_oShaderProgram=e.createProgram(),e.attachShader(this.p_oShaderProgram,this.p_oVertexShader),e.attachShader(this.p_oShaderProgram,this.p_oFragmentShader),e.linkProgram(this.p_oShaderProgram),e.getProgramParameter(this.p_oShaderProgram,e.LINK_STATUS)||alert(\"Could not initialise shaders\"),this.p_oShaderProgram.m_oVertexLocation=e.getAttribLocation(this.p_oShaderProgram,\"aVertexPosition\"),this.p_oShaderProgram.m_oProjectionMatrixLocation=e.getUniformLocation(this.p_oShaderProgram,\"uPMatrix\"),this.p_oShaderProgram.m_oModelViewMatrixLocation=e.getUniformLocation(this.p_oShaderProgram,\"uMVMatrix\"),this.p_oShaderProgram.m_oVertexDeclaration=T.vertexDeclaration,this.p_oColorVertexShader=this.p_oShaderCompiler.compile(\"shader-vs-color\"),this.p_oColorFragmentShader=this.p_oShaderCompiler.compile(\"shader-fs-color\"),this.p_oColorShaderProgram=e.createProgram(),e.attachShader(this.p_oColorShaderProgram,this.p_oColorVertexShader),e.attachShader(this.p_oColorShaderProgram,this.p_oColorFragmentShader),e.linkProgram(this.p_oColorShaderProgram),e.getProgramParameter(this.p_oColorShaderProgram,e.LINK_STATUS)||alert(\"Could not initialise shaders\"),this.p_oColorShaderProgram.m_oVertexLocation=e.getAttribLocation(this.p_oColorShaderProgram,\"aVertexPosition\"),this.p_oColorShaderProgram.m_oVertexColorLocation=e.getAttribLocation(this.p_oColorShaderProgram,\"aVertexColor\"),this.p_oColorShaderProgram.m_oProjectionMatrixLocation=e.getUniformLocation(this.p_oColorShaderProgram,\"uPMatrix\"),this.p_oColorShaderProgram.m_oModelViewMatrixLocation=e.getUniformLocation(this.p_oColorShaderProgram,\"uMVMatrix\"),this.p_oColorShaderProgram.m_oVertexDeclaration=R.vertexDeclaration,this._updateState()}},{key:\"begin\",value:function(){var e=this.p_oGraphicDevice.oWebGLContext,t=this.p_oCurrentShaderProgram.vertexDeclaration;this.p_oWorldViewMatrix.MakeIdentity(),this.p_oWorldViewMatrix.Mult(this.p_oViewMatrix),this.p_oWorldViewMatrix.Mult(this.p_oWorldMatrix),e.enableVertexAttribArray(this.p_oCurrentShaderProgram.m_oVertexLocation),e.vertexAttribPointer(this.p_oCurrentShaderProgram.m_oVertexLocation,3,e.FLOAT,!1,t.stride,0),this.m_bTextureEnabled,this.m_bColorEnabled&&(e.enableVertexAttribArray(this.p_oCurrentShaderProgram.m_oVertexColorLocation),e.vertexAttribPointer(this.p_oCurrentShaderProgram.m_oVertexColorLocation,4,e.FLOAT,!1,t.stride,t.getElementSize(0))),e.uniformMatrix4fv(this.p_oCurrentShaderProgram.m_oProjectionMatrixLocation,!1,new Float32Array(this.p_oProjectionMatrix.byteArray)),e.uniformMatrix4fv(this.p_oCurrentShaderProgram.m_oModelViewMatrixLocation,!1,new Float32Array(this.p_oWorldViewMatrix.byteArray))}},{key:\"end\",value:function(){}},{key:\"_updateState\",value:function(){var e=this.p_oGraphicDevice.oWebGLContext;this.m_bTextureEnabled&&this.m_bColorEnabled?(this.p_eCurrentEffectState=this.constructor.EffectStates.POSITION_COLOR_TEXTURE,this.p_oCurrentShaderProgram=this.p_oTextureColorShaderProgram):this.m_bTextureEnabled?(this.p_eCurrentEffectState=this.constructor.EffectStates.POSITION_TEXTURE,this.p_oCurrentShaderProgram=this.p_oTextureShaderProgram):this.m_bColorEnabled?(this.p_eCurrentEffectState=this.constructor.EffectStates.POSITION_COLOR,this.p_oCurrentShaderProgram=this.p_oColorShaderProgram):(this.p_eCurrentEffectState=this.constructor.EffectStates.POSITION,this.p_oCurrentShaderProgram=this.p_oShaderProgram),e.useProgram(this.p_oCurrentShaderProgram)}},{key:\"worldMatrix\",set:function(e){this.p_oWorldMatrix=e}},{key:\"viewMatrix\",set:function(e){this.p_oViewMatrix=e}},{key:\"projectionMatrix\",set:function(e){this.p_oProjectionMatrix=e}},{key:\"textureEnabled\",set:function(e){this.m_bTextureEnabled=e,this._updateState()}},{key:\"colorEnabled\",set:function(e){this.m_bColorEnabled=e,this._updateState()}}],[{key:\"EffectStates\",get:function(){return{POSITION:0,POSITION_COLOR:1,POSITION_TEXTURE:2,POSITION_COLOR_TEXTURE:3}}}]),e}();function G(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e);this.graphicDevice=new P,this.shaderCompiler=new y,this.basicEffect=new I(this.graphicDevice,this.shaderCompiler)}return function(e,t,r){t&&G(e.prototype,t),r&&G(e,r)}(e,[{key:\"init\",value:function(){try{var e=document.getElementById(\"Canvas3D\"),t=e.getContext(\"experimental-webgl\",!0);t.viewportWidth=e.width,t.viewportHeight=e.height,this.graphicDevice.init(t),this.shaderCompiler.init(t)}catch(e){alert(\"Error initializing WebGL context: \"+e.message)}this.graphicDevice.clearColor=g.BLACK;var r=(new f).makeProjection(45,this.graphicDevice.aspectRatio,.1,100),i=(new f).makeIdentity(),a=(new f).makeIdentity();this.basicEffect.init(),this.basicEffect.projectionMatrix=r,this.basicEffect.viewMatrix=i,this.basicEffect.worldMatrix=a,this.basicEffect.colorEnabled=!0;new R(new o(0,1,0),g.RED),new R(new o(-1,-1,0),g.BLUE),new R(new o(1,-1,0),g.GREEN);this.triangleVertexBuffer=new c(this.graphicDevice,R.vertexDeclaration),this.triangleVertexBuffer.setData(triangleVertexBuffer),alert(\"all ok\")}},{key:\"update\",value:function(e){}},{key:\"draw\",value:function(e){}},{key:\"unload\",value:function(){}}]),e}();window.initGame=function(){new a(new W).initLoop()}}]);","extractedComments":[]}